# CRM 3.0 - –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è

## üìã –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- –†–æ–ª–∏: Admin, Seller (–ü—Ä–æ–¥–∞–≤–µ—Ü), Executor (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å) - –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è
- –í–∏–¥–∏–º–æ—Å—Ç—å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ (–≥–¥–µ –æ–Ω seller –∏–ª–∏ executor) ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –¢–æ–ª—å–∫–æ Admin –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ ‚Üê –¢–ï–ö–£–©–ê–Ø –§–ê–ó–ê
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –Ω–∞ –≤—Å–µ—Ö endpoints (–∫—Ä–æ–º–µ /auth/login/) ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û
- –ü—Ä–æ–µ–∫—Ç: 3-5 —á–µ–ª–æ–≤–µ–∫, –ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å –Ω–µ –Ω—É–∂–Ω–∞

---

## ‚úÖ –§–ê–ó–ê 1-2: –ó–ê–í–ï–†–®–ï–ù–ê (Commit 88376a4)

‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π –≤ –ë–î (Admin, Seller, Executor)
‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤ permissions
‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ IsAuthenticated –∫–æ –≤—Å–µ–º ViewSets
‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DEFAULT_PERMISSION_CLASSES –Ω–∞ IsAuthenticated
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ä–æ–ª–∏ —Å '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' –Ω–∞ 'Admin'

---

## ‚úÖ –§–ê–ó–ê 4: –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ Admin) - –ó–ê–í–ï–†–®–ï–ù–ê (Commit 09e9d46)

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ update/partial_update/destroy
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ EditProtectedMixin –∫–æ –≤—Å–µ–º 9 ViewSets
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ Admin)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π update/destroy (INFO –∏ WARNING —É—Ä–æ–≤–Ω–∏)

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:**
- WARNING: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è
- INFO: –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –∞–¥–º–∏–Ω–æ–º
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –º–æ–¥–µ–ª—å, ID –æ–±—ä–µ–∫—Ç–∞, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è

---

## üü° –§–ê–ó–ê 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –≠—Ç–∞–ø 5.1: –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã - –ó–ê–í–ï–†–®–ï–ù–ê (Commit 09bbfd5)
‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `backend/tests/test_permissions.py` —Å 12 –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏
‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
  - –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è (403)
  - Admin –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ (200/204)
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
  - –ß–∞—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (PATCH) –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã Admin
  - –ù–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –æ—Ç–∫–ª–æ–Ω–µ–Ω (401)
‚úÖ –í—Å–µ 12 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

### –≠—Ç–∞–ø 5.2: –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –ó–ê–í–ï–†–®–ï–ù–ê
‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
  - seller (Seller role)
  - executor (Executor role)
‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Å–¥–µ–ª–∫–∞ (seller = seller, executor = executor)
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã:
  - Seller –º–æ–∂–µ—Ç –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è ‚úì
  - Seller –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–¥–µ–ª–∫–∏ ‚úì
  - Seller –ø–æ–ª—É—á–∞–µ—Ç 403 –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚úì
  - Admin –º–æ–∂–µ—Ç –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è ‚úì
  - Admin –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ —Å–¥–µ–ª–∫–∏ (200 OK) ‚úì

### –≠—Ç–∞–ø 5.3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –ó–ê–í–ï–†–®–ï–ù–ê
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
‚úÖ –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ—à–∏–±–∫—É

---

## ‚úÖ –§–ê–ó–ê 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ó–ê–í–ï–†–®–ï–ù–ê (Commit b954994)

### –≠—Ç–∞–ø 6.1: –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - –ó–ê–í–ï–†–®–ï–ù
‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å APIError –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API
‚úÖ 401 (Unauthorized) ‚Üí –æ—á–∏—â–∞—é—Ç —Ç–æ–∫–µ–Ω—ã –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –Ω–∞ –ª–æ–≥–∏–Ω
‚úÖ 403 (Forbidden) ‚Üí –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç –æ—à–∏–±–∫—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –∏–∑ API responses

### –≠—Ç–∞–ø 6.2: –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –¥–æ—Å—Ç—É–ø–∞ - –ó–ê–í–ï–†–®–ï–ù
‚úÖ –°–æ–∑–¥–∞–Ω NotificationContext –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
‚úÖ –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç NotificationDisplay —Å CSS —Å—Ç–∏–ª—è–º–∏
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ 403 –æ—à–∏–±–æ–∫ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫ (updateDeal)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á (updateTask)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π (updatePayment)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π (updateFinancialRecord)
‚úÖ –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∞–¥–º–∏–Ω–æ–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ"
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- ‚úÖ –í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∫—Ä–æ–º–µ /auth/login, /auth/refresh, /auth/me) - IsAuthenticated –ºixin –ø—Ä–∏–º–µ–Ω–µ–Ω –≤–æ –≤—Å–µ—Ö ViewSets
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –§–ê–ó–ê 2
- ‚úÖ –¢–æ–ª—å–∫–æ Admin –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å - EditProtectedMixin –ø—Ä–∏–º–µ–Ω–µ–Ω –≤–æ –≤—Å–µ—Ö ViewSets (–§–ê–ó–ê 4)
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –§–ê–ó–ê 4
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç - 12/12 —Ç–µ—Å—Ç–æ–≤ –≤ test_permissions.py —É—Å–ø–µ—à–Ω—ã
- ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ - NotificationContext –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ 403 –æ—à–∏–±–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –§–ê–ó–ê 6
- ‚úÖ –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫–æ–¥ - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤–æ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

---

## üéØ –ë—É–¥—É—â–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç üî¥ –í–´–°–û–ö–ê–Ø:**
- ‚è≥ –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º
- ‚è≥ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç üü° –°–†–ï–î–ù–Ø–Ø:**
- ‚è≥ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚è≥ –£–ª—É—á—à–µ–Ω–∏–µ UI –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
